!function(){"use strict";function e(t){if(null===t||"object"!=typeof t)return t;var r=t.constructor();for(var i in t)t.hasOwnProperty(i)&&(r[i]=e(t[i]));return r}function t(e){if("string"!=typeof e)return{};var t,r={},i=(e=e.split("+").join(" ")).match(/(?:[\?](?:[^=]+)=(?:[^&#]*)(?:[&](?:[^=]+)=(?:[^&#]*))*(?:[#].*)?)|(?:[#].*)/);if(null===i)return{};t=i[0].substr(1).split(/[&#=]/);for(var a=0;a<t.length;a+=2)r[decodeURIComponent(t[a])]=decodeURIComponent(t[a+1]||"");return r}function r(e){if("object"!=typeof e)return"";e.params=e.params||{};var t="",r=0,i=Object.keys(e.params);if(0===i.length)return"";for(i.sort(),e.hasParams||(t+="?"+i[0]+"="+e.params[i[0]],r+=1);r<i.length;r+=1)t+="&"+i[r]+"="+e.params[i[r]];return t}function i(e){var t,r=0,i={s:1,m:60,h:3600,d:86400,w:604800};if(!e.match(/^(\d+[smhdw]?)+$/))return 0;t=(e=e.replace(/([smhdw])/g," $1 ").trim()).split(" ");for(var a=0;a<t.length;a+=2)r+=parseInt(t[a],10)*i[t[a+1]||"s"];return r}function a(){this.plugins={}}function s(){this.provider="canalplus",this.defaultFormat="embed",this.formats={embed:this.createEmbedUrl},this.mediaTypes={VIDEO:"video"}}function o(){this.provider="coub",this.defaultFormat="long",this.formats={long:this.createLongUrl,embed:this.createEmbedUrl},this.mediaTypes={VIDEO:"video"}}function p(){this.provider="dailymotion",this.alternatives=["dai"],this.defaultFormat="long",this.formats={short:this.createShortUrl,long:this.createLongUrl,embed:this.createEmbedUrl},this.mediaTypes={VIDEO:"video"}}function n(){this.provider="twitch",this.defaultFormat="long",this.formats={long:this.createLongUrl,embed:this.createEmbedUrl},this.mediaTypes={VIDEO:"video",STREAM:"stream",EMBEDVIDEO:"embed-video",CLIP:"clip"}}function d(){this.provider="vimeo",this.alternatives=["vimeopro"],this.defaultFormat="long",this.formats={long:this.createLongUrl,embed:this.createEmbedUrl},this.mediaTypes={VIDEO:"video"}}function l(){this.provider="youtube",this.alternatives=["youtu","ytimg"],this.defaultFormat="long",this.formats={short:this.createShortUrl,long:this.createLongUrl,embed:this.createEmbedUrl,shortImage:this.createShortImageUrl,longImage:this.createLongImageUrl},this.imageQualities={0:"0",1:"1",2:"2",3:"3",DEFAULT:"default",HQDEFAULT:"hqdefault",SDDEFAULT:"sddefault",MQDEFAULT:"mqdefault",MAXRESDEFAULT:"maxresdefault"},this.defaultImageQuality=this.imageQualities.HQDEFAULT,this.mediaTypes={VIDEO:"video",PLAYLIST:"playlist",SHARE:"share"}}function m(){this.provider="youku",this.defaultFormat="long",this.formats={embed:this.createEmbedUrl,long:this.createLongUrl,flash:this.createFlashUrl,static:this.createStaticUrl},this.mediaTypes={VIDEO:"video"}}a.prototype.parseProvider=function(e){var t=e.match(/(?:(?:https?:)?\/\/)?(?:[^\.]+\.)?(\w+)\./i);return t?t[1]:void 0},a.prototype.removeEmptyParameters=function(e){return e.params&&0===Object.keys(e.params).length&&delete e.params,e},a.prototype.parse=function(e){var r,i=this,a=i.parseProvider(e),s=i.plugins[a];if(a&&s&&s.parse)return(r=s.parse.apply(s,[e,t(e)]))&&((r=i.removeEmptyParameters(r)).provider=s.provider),r},a.prototype.bind=function(e){if(this.plugins[e.provider]=e,e.alternatives)for(var t=0;t<e.alternatives.length;t+=1)this.plugins[e.alternatives[t]]=e},a.prototype.create=function(t){var r=t.videoInfo,i=t.params,a=this.plugins[r.provider];if(i="internal"===i?r.params:i||{},a&&(t.format=t.format||a.defaultFormat,a.formats.hasOwnProperty(t.format)))return a.formats[t.format].apply(a,[r,e(i)])};var c=new a;s.prototype.parseParameters=function(e){return delete e.vid,e},s.prototype.parse=function(e,t){var r=this,i={mediaType:this.mediaTypes.VIDEO,id:t.vid};if(i.params=r.parseParameters(t),i.id)return i},s.prototype.createEmbedUrl=function(e,t){var i="http://player.canalplus.fr/embed/";return t.vid=e.id,i+=r({params:t})},c.bind(new s),o.prototype.parseUrl=function(e){var t=e.match(/(?:embed|view)\/([a-zA-Z\d]+)/i);return t?t[1]:void 0},o.prototype.parse=function(e,t){var r={mediaType:this.mediaTypes.VIDEO,params:t,id:this.parseUrl(e)};if(r.id)return r},o.prototype.createUrl=function(e,t,i){var a=e+t.id;return a+=r({params:i})},o.prototype.createLongUrl=function(e,t){return this.createUrl("https://coub.com/view/",e,t)},o.prototype.createEmbedUrl=function(e,t){return this.createUrl("//coub.com/embed/",e,t)},c.bind(new o),p.prototype.parseParameters=function(e){return this.parseTime(e)},p.prototype.parseTime=function(e){return e.start&&(e.start=i(e.start)),e},p.prototype.parseUrl=function(e){var t=e.match(/(?:\/video|ly)\/([A-Za-z0-9]+)/i);return t?t[1]:void 0},p.prototype.parse=function(e,t){var r=this,i={mediaType:this.mediaTypes.VIDEO,params:r.parseParameters(t),id:r.parseUrl(e)};return i.id?i:void 0},p.prototype.createUrl=function(e,t,i){return e+t.id+r({params:i})},p.prototype.createShortUrl=function(e){return this.createUrl("https://dai.ly/",e,{})},p.prototype.createLongUrl=function(e,t){return this.createUrl("https://dailymotion.com/video/",e,t)},p.prototype.createEmbedUrl=function(e,t){return this.createUrl("//www.dailymotion.com/embed/video/",e,t)},c.bind(new p),n.prototype.seperateId=function(e){return{pre:e[0],id:e.substr(1)}},n.prototype.parseChannel=function(e,t){var r=t.channel||t.utm_content||e.channel;return delete t.utm_content,delete t.channel,r},n.prototype.parseUrl=function(e,t,r){var i;if(i=e.match(/(clips\.)?twitch\.tv\/(\w+)(?:\/(?:(.)\/(\d+)|(\w+)))?/i),t.channel=i?i[2]:void 0,i&&i[3]&&i[4])t.id=i[3]+i[4];else if(r.video)t.id=r.video,delete r.video;else if(i&&i[1]&&i[5])t.id=i[5],t.isClip=!0;else if(r.clip){var a=r.clip.split("/");t.channel=a[0],t.id=a[1],t.isClip=!0,delete r.clip}return t},n.prototype.parseMediaType=function(e){var t;return e.channel?e.id&&e.isClip?(t=this.mediaTypes.CLIP,delete e.isClip):t=e.id&&!e.isClip?this.mediaTypes.VIDEO:this.mediaTypes.STREAM:e.id&&(t=this.mediaTypes.EMBEDVIDEO,delete e.channel),t},n.prototype.parseParameters=function(e){return e.t&&(e.start=i(e.t),delete e.t),e},n.prototype.parse=function(e,t){var r=this,i={};return i=r.parseUrl(e,i,t),i.channel=r.parseChannel(i,t),i.mediaType=r.parseMediaType(i),i.params=r.parseParameters(t),i.channel||i.id?i:void 0},n.prototype.createLongUrl=function(e,t){var i="";if(e.mediaType===this.mediaTypes.STREAM)i="https://twitch.tv/"+e.channel;else if(e.mediaType===this.mediaTypes.VIDEO){var a=this.seperateId(e.id);i="https://twitch.tv/"+e.channel+"/"+a.pre+"/"+a.id,t.start&&(t.t=t.start+"s",delete t.start)}else e.mediaType===this.mediaTypes.CLIP&&(i="https://clips.twitch.tv/"+e.channel+"/"+e.id);return i+=r({params:t})},n.prototype.createEmbedUrl=function(e,t){var i="https://player.twitch.tv/";return e.mediaType===this.mediaTypes.STREAM?t.channel=e.channel:e.mediaType===this.mediaTypes.VIDEO||e.mediaType===this.mediaTypes.EMBEDVIDEO?(t.video=e.id,t.start&&(t.t=t.start+"s",delete t.start)):e.mediaType===this.mediaTypes.CLIP&&(i="https://clips.twitch.tv/embed",t.clip=e.channel+"/"+e.id),i+=r({params:t})},c.bind(new n),d.prototype.parseUrl=function(e){var t=e.match(/(?:\/(?:channels\/[\w]+|(?:(?:album\/\d+|groups\/[\w]+)\/)?videos?))?\/(\d+)/i);return t?t[1]:void 0},d.prototype.parseParameters=function(e){return this.parseTime(e)},d.prototype.parseTime=function(e){return e.t&&(e.start=i(e.t),delete e.t),e},d.prototype.parse=function(e,t){var r={mediaType:this.mediaTypes.VIDEO,params:this.parseParameters(t),id:this.parseUrl(e)};return r.id?r:void 0},d.prototype.createUrl=function(e,t,i){var a=e+t.id,s=i.start;return delete i.start,a+=r({params:i}),s&&(a+="#t="+s),a},d.prototype.createLongUrl=function(e,t){return this.createUrl("https://vimeo.com/",e,t)},d.prototype.createEmbedUrl=function(e,t){return this.createUrl("//player.vimeo.com/video/",e,t)},c.bind(new d),l.prototype.parseUrl=function(e){var t=e.match(/(?:(?:v|vi|be|videos|embed)\/(?!videoseries)|(?:v|ci)=)([\w\-]{11})/i);return t?t[1]:void 0},l.prototype.parseParameters=function(e,t){return(e.start||e.t)&&(e.start=i(e.start||e.t),delete e.t),e.v===t.id&&delete e.v,e.list===t.id&&delete e.list,e},l.prototype.parseMediaType=function(e){if(e.params.list&&(e.list=e.params.list,delete e.params.list),e.id&&!e.params.ci)e.mediaType=this.mediaTypes.VIDEO;else if(e.list)delete e.id,e.mediaType=this.mediaTypes.PLAYLIST;else{if(!e.params.ci)return;delete e.params.ci,e.mediaType=this.mediaTypes.SHARE}return e},l.prototype.parse=function(e,t){var r=this,i={params:t,id:r.parseUrl(e)};return i.params=r.parseParameters(t,i),i=r.parseMediaType(i)},l.prototype.createShortUrl=function(e,t){var r="https://youtu.be/"+e.id;return t.start&&(r+="#t="+t.start),r},l.prototype.createLongUrl=function(e,t){var i="",a=t.start;return delete t.start,e.mediaType===this.mediaTypes.PLAYLIST?(t.feature="share",i+="https://youtube.com/playlist"):e.mediaType===this.mediaTypes.VIDEO?(t.v=e.id,i+="https://youtube.com/watch"):e.mediaType===this.mediaTypes.SHARE&&(t.ci=e.id,i+="https://www.youtube.com/shared"),e.list&&(t.list=e.list),i+=r({params:t}),e.mediaType!==this.mediaTypes.PLAYLIST&&a&&(i+="#t="+a),i},l.prototype.createEmbedUrl=function(e,t){var i="//youtube.com/embed";return e.mediaType===this.mediaTypes.PLAYLIST?t.listType="playlist":(i+="/"+e.id,"1"===t.loop&&(t.playlist=e.id)),e.list&&(t.list=e.list),i+=r({params:t})},l.prototype.createImageUrl=function(e,t,r){return e+t.id+"/"+(r.imageQuality||this.defaultImageQuality)+".jpg"},l.prototype.createShortImageUrl=function(e,t){return this.createImageUrl("https://i.ytimg.com/vi/",e,t)},l.prototype.createLongImageUrl=function(e,t){return this.createImageUrl("https://img.youtube.com/vi/",e,t)},c.bind(new l),m.prototype.parseUrl=function(e){var t=e.match(/(?:(?:embed|sid)\/|v_show\/id_|VideoIDS=)([a-zA-Z0-9]+)/);return t?t[1]:void 0},m.prototype.parseParameters=function(e){return e.VideoIDS&&delete e.VideoIDS,e},m.prototype.parse=function(e,t){var r=this,i={mediaType:this.mediaTypes.VIDEO,id:r.parseUrl(e),params:r.parseParameters(t)};if(i.id)return i},m.prototype.createUrl=function(e,t,i){var a=e+t.id;return a+=r({params:i})},m.prototype.createEmbedUrl=function(e,t){return this.createUrl("http://player.youku.com/embed/",e,t)},m.prototype.createLongUrl=function(e,t){return this.createUrl("http://v.youku.com/v_show/id_",e,t)},m.prototype.createStaticUrl=function(e,t){return this.createUrl("http://static.youku.com/v1.0.0638/v/swf/loader.swf?VideoIDS=",e,t)},m.prototype.createFlashUrl=function(e,t){var i="http://player.youku.com/player.php/sid/"+e.id+"/v.swf";return i+=r({params:t})},c.bind(new m),"undefined"!=typeof window&&(window.urlParser=c),"undefined"!=typeof module&&void 0!==module.exports&&(module.exports=c)}();